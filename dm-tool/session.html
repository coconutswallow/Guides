---
layout: default
title: DM Tool | Session Editor
background_image: /assets/images/still-life-objects-with-role-playing-game-sheet.jpg
extra_css: 
  - /assets/css/dm-tool.css
---

<header class="editor-header">
    <div class="header-inputs">
        <div class="header-game-title-wrapper">
            <input type="text" id="header-game-name" placeholder="Untitled Game Session">
        </div>
        </div>

    <div class="header-actions">
        <span id="save-status" style="margin-right:1rem; color:var(--color-text-secondary); font-size:0.9em;"></span>
        <button id="btn-copy-game" class="button button-secondary" style="margin-right: 10px;">Copy / Next Part</button>
        <button id="btn-save-game" class="button">Save Changes</button>
    </div>
</header>

<div class="editor-container">
    <nav class="editor-sidebar" id="sidebar-nav">
        <div class="nav-item active" data-target="view-start">0. Start / Info</div>
        <div class="nav-divider"></div>
        <div class="nav-item" data-target="view-game-setup">1. Game Setup</div>
        <div class="nav-item" data-target="view-game-listing">2. Game Listing</div>
        <div class="nav-item" data-target="view-game-ad">3. Game Advertisement</div>
        <div class="nav-item" data-target="view-player-setup">4. Player & DM Setup</div>
        <div class="nav-item" data-target="view-loot-plan">5. Plan / Declare Loot</div>
        <div class="nav-divider"></div>
        <div class="nav-item" data-target="view-session-lobby">6. Session Lobby</div>
        <div class="nav-divider"></div>
        <div class="nav-item" data-target="view-session-details">7. Session Details</div>
        <div class="nav-item" data-target="view-session-output">8. Session Log</div>
        <div class="nav-item" data-target="view-mal-update">9. MAL Update</div>
        <div class="nav-item" data-target="view-records">10. Records</div>
    </nav>

    <main class="editor-main">
        
        <div id="view-start" class="view-section">
            <h2>Welcome to the DM Tool</h2>
            <div class="card">
                <p>This tool is intended to make it easy for you to DM in the Hawthorne Server from initial game listing to logging your session. </p>
                <p>For new DMs, it provides a guided step-by-step workflow; for experienced DMs, you can save/load templates to spin up a game in a couple of minutes:</p>

                <img src="../assets/images/DMTool-Flow.png" alt="DM Tool Process">
            </div>
        </div>

        <div id="view-game-setup" class="view-section hidden-section">
            <h2>Game Setup</h2>
            <p class="instruction-text">The first step is to create a game listing and game ad.  Fill in the information on this tab, and use tabs 2 and 3 to create those postings in discord.  Don't forget to save!</p>
            <p class="instruction-text"><strong>Hint:</strong>You can save as a template so that these settings can be re-loaded for future games/sessions.</p>
            
            
            <div class="card" style="border-left: 4px solid var(--color-primary); margin-bottom: 2rem;">
                <h3 class="card-title" style="font-size: 1rem;">Templates</h3>
                <p>Use templates to quickly load your common settings for faster game setup.</p>
                <div class="form-group">
                    <label>Manage Templates</label>
                    <div style="display:flex; gap:10px; align-items: center;">
                        <select id="template-select" style="flex:1; padding: 0.5rem;">
                            <option value="">Select a saved template...</option>
                        </select>
                        <button class="button" id="btn-load-template" title="Load selected template into this form">Load</button>
                        <button class="button button-secondary" id="btn-save-template-setup" title="Save current settings as a new template">Save</button>
                        <button class="button btn-danger-outline" id="btn-delete-template" title="Delete selected template">Delete</button>
                    </div>
                </div>
            </div>

            <div class="accordion-group">
                <div class="card accordion-card open" id="card-listing-basics">
                    <div class="accordion-header">
                        <span class="step-title">Basics</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-row-full" style="gap: 1.5rem;">
                                <div class="form-group" style="flex: 2;">
                                    <label>Start Date & Time <span class="req">*</span>{% include help-icon.html text="Enter the date & time in your own timezone. The tool will translate into Discord timestamp in the output." position="bottom" %}</label>
                                    <input type="datetime-local" id="inp-start-datetime" data-required="true">
                                    <input type="hidden" id="inp-unix-time">
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label>Timezone <span class="req">*</span></label>
                                    <select id="inp-timezone" data-required="true"></select>
                                </div>
                            </div>
                            <div class="form-row-full">
                                <div class="form-group" style="width: 100%;">
                                    <label>Planned Duration <span class="req">*</span></label>
                                    <input type="text" id="inp-duration-text" placeholder="e.g. 3-4 hours, hard stop at 6 hours" data-required="true">
                                </div>
                            </div>
                            <div class="form-group form-row-full">
                                <label>Game Description <span class="req">*</span></label>
                                {% include markdown-widget.html id="inp-description" name="game_description" height="200px" %}
                                <input type="hidden" id="val-description" class="md-trigger" data-required="true">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card accordion-card" id="card-listing-settings">
                    <div class="accordion-header">
                        <span class="step-title">Game Settings</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-group"><label>Game Format <span class="req">*</span></label><select id="inp-format" data-required="true"><option value="">Loading...</option></select></div>
                            <div class="form-group"><label>Game Version <span class="req">*</span></label><select id="inp-version" data-required="true"><option value="">Loading...</option></select></div>
                            <div class="form-group"><label>App Type <span class="req">*</span></label><select id="inp-apps-type" data-required="true"><option value="">Loading...</option></select></div>
                            <div class="form-group"><label>Platform <span class="req">*</span></label><input type="text" id="inp-platform" placeholder="Roll20/Foundry" data-required="true"></div>
                            <div class="form-group"><label>Event(s){% include help-icon.html text="Ctrl-click to multi-select" %}</label><select id="inp-event" multiple></select></div>
                        </div>
                    </div>
                </div>

                <div class="card accordion-card" id="card-listing-party">
                    <div class="accordion-header">
                        <span class="step-title">Party Configuration</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-row-full" style="gap: 1.5rem;">
                                <div class="form-group flex-grow">
                                    <label>Tier (multi-select)<span class="req">*</span></label>
                                    <select id="inp-tier" multiple data-required="true" style="height: 100px;"></select>
                                </div>
                                <div class="form-group flex-grow"><label>APL <span class="req">*</span></label><input type="text" id="inp-apl" placeholder="8" data-required="true"></div>
                                <div class="form-group flex-grow"><label>Party Size <span class="req">*</span></label><input type="text" id="inp-party-size" value="5" data-required="true"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card accordion-card" id="card-listing-tone">
                    <div class="accordion-header">
                        <span class="step-title">Tone & Difficulty</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-group"><label>Tone <span class="req">*</span></label><input type="text" id="inp-tone" placeholder="e.g. Serious" data-required="true"></div>
                            <div class="form-group"><label>Focus <span class="req">*</span></label><input type="text" id="inp-focus" placeholder="e.g. 50/50" data-required="true"></div>
                            <div class="form-group"><label>Difficulty <span class="req">*</span></label><input type="text" id="inp-diff-encounter" placeholder="Hard" data-required="true"></div>
                            <div class="form-group"><label>Enemy Threat Level <span class="req">*</span></label><input type="text" id="inp-diff-threat" placeholder="Deadly" data-required="true"></div>
                            <div class="form-group"><label>Chance of Character Loss <span class="req">*</span></label><input type="text" id="inp-diff-loss" placeholder="Medium" data-required="true"></div>
                        </div>
                    </div>
                </div>

                <div class="card accordion-card" id="card-listing-details">
                    <div class="accordion-header">
                        <span class="step-title">Details & Rules</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-group form-row-full"><label>House Rules</label>{% include markdown-widget.html id="inp-houserules" name="house_rules" height="150px" %}</div>
                            <div class="form-group form-row-full"><label>Notes</label>{% include markdown-widget.html id="inp-notes" name="notes" height="150px" %}</div>
                            <div class="form-group form-row-full"><label>Content Warnings</label>{% include markdown-widget.html id="inp-warnings" name="content_warnings" height="100px" %}</div>
                            <div class="form-group form-row-full">
                                <label>How to Apply <span class="req">*</span></label>
                                {% include markdown-widget.html id="inp-apply" name="how_to_apply" height="200px" %}
                                <input type="hidden" id="val-apply" class="md-trigger" data-required="true">
                            </div>
                        </div>
                    </div>
                </div>
            </div> 
        </div>

        <div id="view-game-listing" class="view-section hidden-section">
            <h2>Game Posting to #Game-Listings</h2>
            <p class="instruction-text">If you use a permanent session lobby, copy the link to your lobby below.  If you don't, leave it blank and we'll create it in Step 6.</p>  
            <p class="instruction-text">Review the game listing below, click the "copy to clipboard" button, then post this in <a href="https://discord.com/channels/308324031478890497/1366924010255814768">#game-listings</a></p>
                <div class="card">
                <div class="form-group" style="margin-bottom: 2rem;">
                    <label>Game Lobby URL</label>
                    <input type="text" id="inp-lobby-url" value="TBD">
                </div>
                <h3>Game Listing Text:</h3>
                {% include discord-output.html id="out-listing-text" channel_name="#game-listings" height="600px" %}
                
                <div style="margin-top: 2rem; border-top: 1px solid var(--color-border); padding-top: 1rem; text-align: right;">
                        <button class="button button-secondary" id="btn-open-save-template">Save As Template</button>
                </div>
            </div>
        </div>

        <div id="view-game-ad" class="view-section hidden-section">
            <h2>Game Advertisement</h2>
            <p class="instruction-text">Now that you have your game listing posted, it's time to create a game advertisement.  In discord, right-click and copy a link to your game listing and paste it in the field below.  Then click on the "copy to clipboard" button and post it to <a href="https://discord.com/channels/308324031478890497/1366924010255814768">#game-advertisement</a></p>
            <div class="card">
                <div class="form-group">
                    <label>Game Listing URL</label>
                    <input type="text" id="inp-listing-url" placeholder="Link to the #game-listings post" data-required="true">
                </div>
                <h3>Game Advertisement Text</h3>
                {% include discord-output.html id="out-ad-text" channel_name="#game-ads" height="200px" %}
            </div>
            <p>Once you've posted your advertisement, make sure you <b>save your data</b> here, and feel free to close out of the tool.  Come back and proceed to Step 4 when you've picked your players!</p>
            
        </div>

        <div id="view-player-setup" class="view-section hidden-section">
            <h2>Player & DM Setup</h2>
            <p class="instruction-text"><b>There are 2 ways to manage your player roster data:</b><br> 1. Manually enter the player details below. <br>2. Create a link to a custom data entry page, and share the link with your selected players. Once they've completed the form, press <b>Sync Data</b> button to pull the data into the tool.</p>
            <div class="card">
                <div style="background: var(--color-bg-medium); padding: 15px; border-radius: 4px; border: 1px solid var(--color-border); margin-bottom: 1.5rem; display: flex; align-items: center; gap: 10px; flex-wrap: wrap;">
                    <button class="button button-secondary btn-sm" id="btn-generate-invite" title="Create a link for players to edit their own data">
                        Create Player Invite Link
                    </button>
                    <input type="text" id="inp-invite-link" class="table-input" style="flex: 1; min-width: 200px;" readonly placeholder="Link will appear here...">
                    <button class="button btn-sm" id="btn-copy-invite" title="Copy to clipboard">
                        Copy
                    </button>
                    <div style="width: 1px; height: 24px; background: var(--color-border); margin: 0 4px;"></div>
                    <button class="button button-secondary btn-sm" id="btn-sync-submissions" title="Pull data from player submissions into this table">
                        Sync Data
                    </button>
                </div>

                <div class="session-stats-bar" style="margin-bottom: 1rem;">
                    <div class="stat-item">
                        <span class="stat-label">Party Size:</span>
                        <span class="stat-value" id="setup-val-party-size">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">APL:</span>
                        <span class="stat-value" id="setup-val-apl">0</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Tier:</span>
                        <span class="stat-value" id="setup-val-tier">1</span>
                    </div>
                </div>
                
                <table class="roster-table" style="width:100%; border-collapse: separate; border-spacing: 0 10px;">
                    <thead>
                        <tr>
                            <th style="width: 20%;">Player Name</th>
                            <th style="width: 25%;">Character Name</th>
                            <th style="width: 8%;">Level</th>
                            <th style="width: 18%;">Level <span style="font-size:0.6em; font-weight:normal;">(Playing As)</span>{% include help-icon.html text="Optional if a player is playing at a lower level than their current level" %}</th>
                            <th style="width: 9%;">Games on Server</th>
                            <th style="width: 10%;">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="roster-body"></tbody>
                </table>

                <div style="display: flex; justify-content: right; margin-top: 1rem;">
                    <button id="btn-add-player" class="button btn-sm" style="width: 20%;">+ Add Player</button>
                </div>
            </div>
            
            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">Dungeon Master Details</h3>
                <div class="form-row-full" style="align-items: flex-end; gap: 1rem;">
                    <div class="form-group flex-grow"><label>DM Character Name</label><input type="text" id="inp-dm-char-name" placeholder="Character Name"></div>
                    <div class="form-group" style="width: 100px;"><label>DM PC Level</label><input type="number" id="inp-dm-level" placeholder="Lvl"></div>
                    <div class="form-group" style="width: 140px;"><label>Games DM'ed on Server</label><select id="inp-dm-games-count"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option><option value="10+">10+</option></select></div>
                </div>
            </div>
            
            <div class="card" style="margin-top: 2rem;">
                <h3 class="card-title">DM Collaborators</h3>
                <div class="form-group">
                    <label>DM Collaboration Link</label>
                    <input type="text" id="inp-dm-collab-link" placeholder="Enter collaboration link">
                </div>
                <div class="form-group">
                    <label>DM Collaborators {% include help-icon.html text="Enter Discord names of collaborating DM(s). If more than 1, please separate each with a comma (e.g. @DMName1, @DMName2)" %}</label>
                    <textarea id="inp-dm-collaborators" class="table-input" rows="3" placeholder="@DMName1, @DMName2, @DMName3"></textarea>
                </div>
            </div>
        </div>

        <div id="view-loot-plan" class="view-section hidden-section">
            <h2>Plan / Declare Loot</h2>
            <p class="instruction-text">This tab will help you plan and declare player and DM loot rewards for this session.  <b>Note:</b> you can declare loot at any time (up to the end of the session).</p>
            
            <div class="accordion-group">
                <div class="card accordion-card open">
                    <div class="accordion-header">
                        <span class="step-title">Player Loot Determination:</span>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <p class="instruction-text">The rules for the type and amount of loot you can award in your session is documented in the <a href="https://drive.google.com/file/d/1MiXp60GBg2ZASiiGjgFtTRFHp7Jf0m2P/view?usp=sharing" target="_blank">DM Guide</a>.  A summary can be found below:</p>
                        
                        <div id="out-loot-instructions" style="margin-top: 1rem; padding: 10px; background: var(--color-bg-medium); border-left: 3px solid var(--color-primary); border-radius: 4px; font-size: 0.95em;">
                            <span style="color: var(--color-text-secondary);">Loading instructions...</span>
                        </div>

                        <p class="instruction-text">You can choose to pre-determine loot (select appropriate loot from the <a href="https://docs.google.com/spreadsheets/d/1fBEv1yDNTD-vwUyK6pK_oiXg2K7OiltW35iFCqxyMTY/edit?gid=867745632#gid=867745632">Allowed Content</a>, according to the rules above), use the <b><i>HGENLOOT</i></b> bot to roll for loot, or a combination of both.</p>

                        <div class="form-group" style="margin-top: 2rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                            <label>Pre-determined Player Loot</label>
                            <p class="instruction-text">If you choose to pre-determine (select your own loot from the AC), Use the form below to help you declare your selected loot.  Enter your pre-determined loot below (one item per line). This will automatically format the Discord declaration below.</p>
                            <textarea id="inp-loot-plan" class="table-input" rows="6" placeholder="* Item 1&#10;* Item 2"></textarea>
                        </div>

                        <div class="form-group" style="margin-top: 1.5rem;">
                            <label>Output for Discord:</label>
                            <p>Copy to clipboard and post to <a href="https://discord.com/channels/308324031478890497/617808735770902718">#Treasure-Log</a></p>
                            <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                <textarea id="out-loot-declaration" class="out-session-text" style="width: 100%; height: 150px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                            </div>
                            <div style="margin-top: 0.5rem; text-align: right;">
                                <button class="button" onclick="window.copyToClipboard('out-loot-declaration')">Copy to Clipboard</button>
                            </div>
                        </div>

                        <div class="hgen-section" style="margin-top: 2rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                            <h4>Hgenloot Bot</h4>
                            <p> You can also use the bot to randomly roll loot if you do not wish to select the treasures yourself.</p>
                            <p>Please refer the <a href="https://discord.com/channels/308324031478890497/617838916929847315/1423099262845190196" target="_blank">Bot Patch Update</a> for the full explanation of the Hgenloot bot.  You can use the bot to roll for all of your loot, or partially (in combination with pre-determined loot, if applicable).  If in combination, enter the number of predetermine permanents and/or consumables below.</p>
                            
                            <div style="display: flex; gap: 2rem; margin-bottom: 1.5rem; flex-direction: row; align-items: flex-end;">
                                <div class="form-group">
                                    <label>Predetermined Permanents</label>
                                    <input type="number" id="inp-predet-perms" value="0" min="0" style="width: 180px;">
                                </div>
                                <div class="form-group">
                                    <label>Predetermined Consumables</label>
                                    <input type="number" id="inp-predet-cons" value="0" min="0" style="width: 180px;">
                                </div>
                            </div>

                            <div class="form-group">
                                <label>1. Copy this into <a href="https://discord.com/channels/308324031478890497/617808735770902718">#Treasure-Log</a></label>
                                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                    <textarea id="out-hgen-declaration" class="out-session-text" style="width: 100%; height: 80px; padding: 1rem; background: #36393f; color: #dcddde; border: none; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                                </div>
                                <div style="text-align: right; margin-top: 0.5rem;">
                                    <button class="button" onclick="window.copyToClipboard('out-hgen-declaration')">Copy to Clipboard</button>
                                </div>
                            </div>

                            <div class="form-group" style="margin-top: 1.5rem;">
                                <label>2. Reply to that message, and run this command (note: copy-pasting won't work. Please type it manually):</label>
                                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                    <textarea id="out-hgen-command" class="out-session-text" style="width: 100%; height: 60px; padding: 1rem; background: #36393f; color: #dcddde; border: none; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                                </div>
                                <img src="../assets/images/hgenloot.png" alt="Hgenloot Bot">
                            </div>
                            
                            <div class="form-group" style="margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1rem;">
                                <label>Optional: Save links to your Player Loot roll/declaration discord messages here:</label>
                                <textarea id="inp-player-loot-links" class="table-input" rows="3" placeholder="Paste Discord message links here..."></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card accordion-card" id="card-dm-loot">
                    <div class="accordion-header">
                        <span class="step-title">DM Loot Determination</span>
                        <p class="instruction-text">The base DM loot is 1 rolled loot item based on your DMPC's level.  You can increase the number of loot slots (choices to pick from) with incentives, primarily by choosing New Hires (players with less than 10 games) and Welcome Wagon (a player's first game).  There maybe additional incentives based on events on the server, which you can choose with the "Additional Incentives" button below.</p>
                        <span class="step-icon"></span>
                    </div>
                    <div class="accordion-body">
                        <div class="form-grid">
                            <div class="form-group" style="grid-column: 1 / -1; display: flex; flex-direction: row; gap: 1.5rem; align-items: flex-end;">
                                <div style="flex: 1;">
                                    <label style="display:block; margin-bottom:0.5rem; font-weight:600;">New Hires (Players &lt; 10 games)</label>
                                    <input type="text" id="loot-val-newhires" class="table-input readonly-input" readonly value="0">
                                </div>
                                <div style="flex: 1;">
                                    <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Welcome Wagon (First game)</label>
                                    <input type="text" id="loot-val-welcome" class="table-input readonly-input" readonly value="0">
                                </div>
                                <div style="flex: 1;">
                                    <label style="display:block; margin-bottom:0.5rem; font-weight:600;">Jumpstart DM?</label>
                                    <input type="text" id="loot-val-jumpstart" class="table-input readonly-input" readonly value="No">
                                </div>
                            </div>

                            <div class="form-group" style="grid-column: 1 / -1; margin-top: 0.5rem;">
                                <label>Additional DM Incentives (Loot & DTP)</label>
                                <div class="dtp-wrapper" style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                                    <input type="text" id="disp-dm-incentives" class="table-input readonly-input" readonly placeholder="None selected" style="flex: 1; min-width: 200px;">
                                    <button class="button button-secondary" id="btn-dm-loot-incentives" data-incentives='[]'>Add Additional Incentives</button>
                                </div>
                            </div>

                            <div class="form-group" style="grid-column: 1 / -1; margin-top: 1.5rem;">
                                <label>1. Discord Declaration</label>
                                <p>Copy to clipboard and post to <a href="https://discord.com/channels/308324031478890497/617808735770902718">#Treasure-Log</a></p>
                                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                    <textarea id="out-dm-loot-decl" class="out-session-text" style="width: 100%; height: 100px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                                </div>
                                <div style="text-align: right; margin-top: 0.5rem;">
                                    <button class="button" onclick="window.copyToClipboard('out-dm-loot-decl')">Copy Declaration</button>
                                </div>
                            </div>

                            <div class="form-group" style="grid-column: 1 / -1; margin-top: 1.5rem;">
                                <label>2. Bot Command</label>
                                <p class="instruction-text" style="margin-bottom: 0.5rem;">Reply to your declaration with this command (copy and paste won't work, type this command):</p>
                                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                    <textarea id="out-dm-loot-cmd" class="out-session-text" style="width: 100%; height: 60px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                                </div>
                            </div>

                            <div id="wrapper-jumpstart-bonus" class="form-group" style="grid-column: 1 / -1; display:none; margin-top: 1.5rem; border-top: 1px dashed var(--color-border); padding-top: 1rem;">
                                <label>3. Jumpstart Bonus</label>
                                
                                <p>As a Jumpstart DM (DMing your first 10 games on the server), you get an additional loot roll (type this command):</p>
                                
                                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                                    <textarea id="out-dm-jumpstart-cmd" class="out-session-text" style="width: 100%; height: 60px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                                </div>
                            </div>
                        </div>
                        <p>Once you have rolled your loot, edit your original declaration post with "and selects:" and write the loot you chose from the loot pool (1 for normal loot, 1 for jumpstart if applicable).</p>
                        
                        <div class="form-group" style="margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1.5rem;">
                            <label class="field-label">Loot Selected</label>
                            <input type="text" id="dm-loot-selected" class="table-input" placeholder="Enter Loot Selected...">
                        </div>
                        
                        <div class="form-group" style="margin-top: 1.5rem; border-top: 1px solid var(--color-border); padding-top: 1rem;">
                            <label>Optional: Save links to your DMLoot roll/declaration discord messages here:</label>
                            <textarea id="inp-dm-loot-links" class="table-input" rows="2" placeholder="Paste Discord message links here..."></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="view-session-lobby" class="view-section hidden-section">
            <h2>Session Lobby</h2>
            <p class="instruction-text">Create your session lobby message to ping all players and direct them to the game listing.</p>
            
            <div class="card">
                <div class="form-group">
                    <label>Game Listing URL {% include help-icon.html text="Paste the URL to your game listing (e.g., Discord message link)" %}</label>
                    <input type="text" id="inp-game-listing-url" placeholder="https://discord.com/channels/...">
                </div>

                <div class="form-group" style="margin-top: 2rem;">
                    <label>Session Lobby Output:</label>
                    <p class="instruction-text">Copy this message and post it to your session lobby channel to notify all players.</p>
                    <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                        <textarea id="out-session-lobby" class="out-session-text" style="width: 100%; height: 150px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                    </div>
                    <div style="margin-top: 0.5rem; text-align: right;">
                        <button class="button" onclick="window.copyToClipboard('out-session-lobby')">Copy to Clipboard</button>
                    </div>
                </div>
            </div>
        </div>



        <div id="view-session-details" class="view-section hidden-section">
    <h2 class="session-header-title">Session Details</h2>
    <p class="instruction-text">Log your actual session data here. The roster is automatically synced from the Setup tab.</p>
    
    <div class="accordion-group">
        <div class="card accordion-card open">
            <div class="accordion-header">
                <span class="step-title">Session Info</span>
                <span class="step-icon"></span>
            </div>
            <div class="accordion-body">
                <div class="form-grid" style="margin-bottom:0;">
                    <div class="form-row-full" style="display: flex; gap: 1rem; align-items: flex-end;">
                        <div class="form-group" style="flex: 1;">
                            <label>Session Date</label>
                            <input type="datetime-local" id="inp-session-date">
                            <input type="hidden" id="inp-session-unix">
                        </div>
                        <div class="form-group" style="width: 140px;">
                            <label>Session Hours</label>
                            <input type="number" id="inp-session-total-hours" value="3" step="0.5" min="0">
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="card accordion-card open">
            <div class="accordion-header">
                <span class="step-title">Player Logs</span>
                <span class="step-icon"></span>
            </div>
            <div class="accordion-body">
                <div class="session-stats-bar">
                    <div class="stat-item">
                        <span class="stat-label">Max Gold:</span>
                        <span class="stat-value val-max-gold">0</span>
                    </div>
                    <div class="stat-item" style="margin-left: auto;">
                        <button class="button button-secondary btn-sm" id="btn-sync-session" title="Sync Loot/Notes/Gold from Player Submissions">
                            ↓ Sync Player Submissions
                        </button>
                    </div>
                </div>

                <div id="session-roster-list" class="player-roster-list"></div>
               
            </div>
        </div>

        <div class="card accordion-card">
            <div class="accordion-header">
                <span class="step-title">DM Logs</span>
                <span class="step-icon"></span>
            </div>
            <div class="accordion-body">
                <div class="player-card-body" style="padding:0;">
                    <input type="hidden" id="out-dm-name">
                    <input type="hidden" id="out-dm-level">
                    <input type="hidden" id="out-dm-games">

                    <div class="card-row">
                        <div class="card-field w-20">
                            <label class="field-label">Jumpstart</label>
                            <input type="text" class="table-input dm-val-jumpstart readonly-input" readonly>
                        </div>
                        <div class="card-field w-20">
                            <label class="field-label">Welcome Wagon</label>
                            <input type="text" class="table-input dm-val-welcome readonly-input" readonly>
                        </div>
                        <div class="card-field w-20">
                            <label class="field-label">New Hires</label>
                            <input type="text" class="table-input dm-val-newhires readonly-input" readonly>
                        </div>
                        <div class="card-field w-30">
                            <label class="field-label">Add. Incentives</label>
                            <input type="text" id="out-dm-incentives-display" class="table-input readonly-input" readonly placeholder="Set in Loot Plan tab" style="font-style:italic;">
                        </div>
                    </div>

                    <div class="card-row" style="margin-top:1rem;">
                        <div class="card-field w-30">
                            <label class="field-label">Total DTP</label>
                            <input type="text" class="table-input dm-res-dtp readonly-result" readonly>
                        </div>
                        
                        <div class="card-field w-25">
                            <label class="field-label">XP Earned</label>
                            <input type="text" class="table-input dm-res-xp readonly-result" readonly>
                        </div>

                        <div class="card-field w-15" style="text-align:center;">
                             <label class="field-label" style="display:block; width:100%; cursor:pointer;">Forfeit XP</label>
                             <div style="height:38px; display:flex; align-items:center; justify-content:center;">
                                <input type="checkbox" id="chk-dm-forfeit-xp" style="width:18px; height:18px; cursor:pointer;">
                             </div>
                        </div>
                        
                        <div class="card-field w-30">
                            <label class="field-label">GP Earned</label>
                            <input type="text" class="table-input dm-res-gp readonly-result" readonly>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card accordion-card">
            <div class="accordion-header">
                <span class="step-title">Documentation</span>
                <span class="step-icon"></span>
            </div>
            <div class="accordion-body">
                <div class="form-group" style="margin-bottom: 1.5rem;">
                    <label>Session Notes</label>
                    <textarea id="inp-session-notes" class="table-input" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>DM Collaboration</label>
                    <textarea id="inp-dm-collab" class="table-input" rows="1"></textarea>
                </div>
                <div class="form-group">
                    <label for="session-summary">
                        Session Summary
                        {% include help-icon.html text="Brief overview of the session's key events and outcomes." %}
                    </label>
                    <div class="markdown-widget">
                        <textarea id="session-summary" class="form-control" rows="3" placeholder="Summary..."></textarea>
                        <div id="session-summary-preview" class="markdown-preview d-none"></div>
                    </div>
                </div>
            </div>
        </div>
    </div> 
</div>

        <div id="view-session-output" class="view-section hidden-section">
            <h2>Session Log</h2>
            <p class="instruction-text">Copy the session-log below and past it in <a href="https://discord.com/channels/308324031478890497/343418646300852225">#session-logs</a></p>
            
            <div class="card" style="margin-bottom: 2rem;">
                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                    <div class="discord-header" style="background: #2f3136; color: #dcddde; padding: 8px 12px; font-size: 0.9em; font-weight: bold; border-bottom: 1px solid #202225;">
                        # session-logs <span id="part-1-label" style="opacity: 0.7; font-weight: normal; margin-left: 5px;"></span>
                    </div>
                    <div style="position: relative;">
                        <textarea id="out-session-text" class="out-session-text" style="width: 100%; height: 500px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;"></textarea>
                    </div>
                </div>
                <div style="margin-top: 0.5rem; text-align: right;">
                    <button class="button" onclick="window.copyToClipboard('out-session-text')">Copy to Clipboard</button>
                </div>
            </div>
            
            <div class="card" style="margin-bottom: 2rem;">
                <div class="form-group">
                    <label>Optional: Save links to your session-log discord messages here:</label>
                    <textarea id="inp-session-log-links" class="table-input" rows="2" placeholder="Paste Discord message links here..."></textarea>
                </div>
            </div>

            <div class="card" style="margin-bottom: 2rem;">
                <h3>Session Summary for your players:</h3>
                 <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                    <textarea id="out-player-summary" class="out-session-text" style="width: 100%; height: 300px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;" readonly></textarea>
                </div>
                <div style="margin-top: 0.5rem; text-align: right;">
                    <button class="button" onclick="window.copyToClipboard('out-player-summary')">Copy to Clipboard</button>
                </div>
            </div>

            <div id="secondary-output-wrapper" class="card d-none" style="display:none;">
                <div class="discord-output-wrapper" style="border: 1px solid var(--color-border); border-radius: 6px; overflow: hidden;">
                    <div class="discord-header" style="background: #2f3136; color: #f1c40f; padding: 8px 12px; font-size: 0.9em; font-weight: bold; border-bottom: 1px solid #202225;">
                        # session-logs (Part 2: Summary)
                    </div>
                    <div style="position: relative;">
                        <textarea id="out-summary-text" class="out-session-text" style="width: 100%; height: 300px; padding: 1rem; background: #36393f; color: #dcddde; border: none; resize: vertical; font-family: monospace; box-sizing: border-box;"></textarea>
                    </div>
                </div>
                <div style="margin-top: 0.5rem; display: flex; justify-content: space-between; align-items: center;">
                    <span style="color: var(--color-text-secondary); font-size: 0.85em;">⚠️ Output exceeded 999 characters and was split at the summary.</span>
                    <button class="button" onclick="window.copyToClipboard('out-summary-text')">Copy Part 2</button>
                </div>
            </div>
        </div>

        <div id="view-mal-update" class="view-section hidden-section">
            <h2>MAL Update</h2>
            <p class="instruction-text">Copy this tab-delimited row and paste it into your MAL spreadsheet.</p>
            <div class="card">
                <textarea id="out-mal-update" class="table-input" rows="3" readonly style="font-family: monospace;"></textarea>
                <div style="margin-top: 0.5rem; text-align: right;">
                    <button class="button" onclick="window.copyToClipboard('out-mal-update')">Copy to Clipboard</button>
                </div>
            </div>
            <img src="../assets/images/session-mal-paste.png" alt="Where to paste your MAL update">
            <p>Paste your copied MAL update here.</p>
        </div>

        <div id="view-records" class="view-section hidden-section">
            <h2>Record Keeping</h2>
            <p class="instruction-text">A summary of your generated links and logs for your personal records.</p>
            <div class="card">
                <table class="roster-table" style="width:100%; border-collapse: separate; border-spacing: 0 10px;">
                    <thead>
                        <tr style="text-align:left;">
                            <th style="width: 25%; padding: 8px;">Record Type</th>
                            <th style="width: 75%; padding: 8px;">Link / Content</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">Game Listing</td>
                            <td><input type="text" id="rec-listing-link" class="table-input readonly-input" readonly></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">Game Ad</td>
                            <td><input type="text" id="rec-ad-link" class="table-input readonly-input" readonly></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">Session Lobby</td>
                            <td><input type="text" id="rec-lobby-link" class="table-input readonly-input" readonly></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">Player Treasure Log(s)</td>
                            <td><textarea id="rec-player-loot-links" class="table-input readonly-input" rows="3" readonly></textarea></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">DM Treasure Log(s)</td>
                            <td><textarea id="rec-dm-loot-links" class="table-input readonly-input" rows="2" readonly></textarea></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">DM Collaboration Log</td>
                            <td><input type="text" id="rec-dm-collab-link" class="table-input readonly-input" readonly></td>
                        </tr>
                        <tr>
                            <td style="padding: 8px; font-weight: bold;">Session Log</td>
                            <td><textarea id="rec-session-log-links" class="table-input readonly-input" rows="2" readonly></textarea></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>


    </main>
</div>

<dialog id="modal-copy-game">
    <h3 style="margin-top:0;">Copy Game / Create Next Part (Multi-session)</h3>
    <p>Create a new game record based on this one.</p>
    
    <div class="form-group">
        <label>New Game Name</label>
        <input type="text" id="inp-copy-name">
    </div>
    
    <div class="form-group" style="margin: 1.5rem 0; width: 100%;">
        <div style="display:flex; align-items:center; gap:10px; cursor:pointer;">
            <input type="checkbox" id="chk-next-part" style="width: 18px; height: 18px; cursor:pointer;">
            <label for="chk-next-part" style="margin:0; font-weight:600; cursor:pointer; font-size:1.1em;">Copy as Next Part?</label>
        </div>
        <p style="font-size:0.9em; color:var(--color-text-secondary); margin-left:28px; margin-top: 4px; line-height: 1.4;">
            If checked, this will increment the "Games Played" count for all players and the DM in the new record<br>
            and set Application Type to "Pre-filled".
        </p>
    </div>

    <div style="margin-top: 1.5rem; display: flex; justify-content: flex-end; gap: 1rem;">
        <button class="button button-secondary" onclick="document.getElementById('modal-copy-game').close()">Cancel</button>
        <button class="button" id="btn-confirm-copy">Create Copy</button>
    </div>
</dialog>

<dialog id="modal-save-template">
    <h3 style="margin-top:0;">Save As Template</h3>
    <p>Enter a name for this template.</p>
    <div class="form-group">
        <label>Template Name</label>
        <input type="text" id="inp-template-name">
    </div>
    <div style="margin-top: 1.5rem; display: flex; justify-content: flex-end; gap: 1rem;">
        <button class="button button-secondary" onclick="document.getElementById('modal-save-template').close()">Cancel</button>
        <button class="button" id="btn-confirm-save-template">Save</button>
    </div>
</dialog>

<dialog id="modal-incentives">
    <h3 style="margin-top:0;">Select Incentives</h3>
    <div id="incentives-message" style="margin-bottom:1rem; font-size:0.9em; color:var(--color-text-secondary);">
        Check incentives that apply.
    </div>
    <div id="incentives-list" class="checkbox-list"></div>
    <div style="margin-top: 1.5rem; display: flex; justify-content: flex-end; gap: 1rem;">
        <button class="button button-secondary" id="btn-cancel-incentives">Cancel</button>
        <button class="button" id="btn-save-incentives">Apply Incentives</button>
    </div>
</dialog>

<script type="module" src="../assets/js/dm-tool/session-editor.js"></script>