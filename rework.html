---
layout: default
title: Character Rework Tool
extra_css:
  - "{{ '/assets/css/style.css' | relative_url }}"
---

<style>
    /* --- AUTH COMPONENT STYLES --- */
    .auth-wrapper { 
        display: flex; 
        align-items: center; 
        gap: 15px;
        font-family: var(--font-header, sans-serif); 
        font-size: 0.9em;
        margin: 1rem 0 2rem 0; /* Adjusted margins */
        padding-bottom: 1rem;
        border-bottom: 1px solid var(--color-border);
        justify-content: center; /* Center align under title */
    }

    .auth-loading-text { 
        color: var(--color-text-secondary, #888); 
        font-style: italic; 
    }
    
    .auth-btn { 
        border: none; 
        cursor: pointer; 
        display: inline-flex; 
        align-items: center; 
        justify-content: center; 
        transition: all 0.2s ease; 
        font-family: inherit;
        text-transform: uppercase;
        font-weight: 600;
        border-radius: 4px;
    }

    .auth-btn-discord { 
        background-color: #5865F2; 
        color: white; 
        padding: 0.6em 1.2em;
        gap: 10px;
        box-shadow: var(--shadow-sm);
    }
    
    .auth-btn-discord:hover { 
        background-color: #4752C4; 
        transform: translateY(-2px);
    }
    
    .discord-logo { fill: white; }

    .auth-profile { 
        display: flex; 
        align-items: center; 
        gap: 12px; 
        background-color: var(--color-bg-light, #FDF1DC); 
        border: 2px solid var(--color-border, #D4C4B0);
        color: var(--color-text, #2c2c2c);
        padding: 6px 12px; 
        border-radius: var(--border-radius, 4px); 
        box-shadow: var(--shadow-sm);
    }

    .auth-avatar { 
        width: 32px; 
        height: 32px; 
        border-radius: 50%; 
        object-fit: cover; 
        border: 2px solid var(--color-primary, #58180D);
    }

    .auth-user-info { 
        display: flex; 
        flex-direction: column; 
        line-height: 1.2; 
    }

    .auth-name { font-weight: 700; font-size: 0.9em; color: var(--color-primary, #58180D); }
    .auth-role-badge { font-size: 0.8em; color: var(--color-text-secondary, #5a5a5a); }

    .auth-btn-logout { 
        background: transparent; 
        color: var(--color-text-secondary, #5a5a5a); 
        padding: 4px;
        margin-left: 8px;
        border-radius: 4px;
    }
    .auth-btn-logout:hover { color: #c00; background-color: rgba(0,0,0,0.05); }

    /* --- RESPEC TOOL STYLES --- */
    .respec-container {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 2rem;
        margin-top: 1rem;
    }

    @media (max-width: 1000px) {
        .respec-container { grid-template-columns: 1fr; }
    }

    .char-column { display: flex; flex-direction: column; gap: 1.5rem; }

    .column-header {
        text-align: center;
        border-bottom: 2px solid var(--color-primary);
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
        color: var(--color-primary);
        font-family: var(--font-header);
    }

    /* Unified Origin Block Styles */
    .origin-grid { display: flex; flex-direction: column; gap: 1rem; }
    .input-group { display: flex; flex-direction: column; gap: 0.25rem; }
    
    .input-label {
        font-size: 0.9em;
        font-weight: bold;
        color: var(--color-text-secondary);
        text-transform: uppercase;
        display: flex;
        justify-content: space-between;
    }

    .text-input {
        width: 100%;
        padding: 8px;
        border: 1px solid var(--color-border);
        border-radius: 4px;
        background: var(--color-bg-page);
        color: var(--color-text);
    }
    
    .notes-area {
        width: 100%;
        padding: 10px;
        border: 1px solid var(--color-border);
        border-radius: 4px;
        background: var(--color-bg-page);
        color: var(--color-text);
        resize: vertical;
        min-height: 100px;
        font-family: var(--font-body);
    }

    /* Tables */
    .stat-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 0.5rem;
        font-size: 0.9em;
    }

    .stat-table th {
        background: var(--color-primary);
        color: white;
        padding: 6px;
        text-align: center;
        border: 1px solid var(--color-primary);
    }

    .stat-table td {
        padding: 6px;
        text-align: center;
        border: 1px solid var(--color-border);
        background: var(--color-bg-medium);
    }

    .final-stats-table th { background: var(--color-secondary); }
    .final-stats-table td { font-weight: bold; font-size: 1.1em; background: var(--color-bg-page); }

    .attr-input-cell {
        width: 100%; max-width: 60px; text-align: center; padding: 4px;
        border: 1px solid var(--color-border); font-weight: bold;
    }

    .mod-select-cell {
        width: 100%; text-align: center; padding: 4px;
        border: 1px solid var(--color-border); background: var(--color-bg-page);
        color: var(--color-text); cursor: pointer;
    }

    .points-display {
        text-align: center; font-weight: bold; padding: 0.5rem; margin-top: 0.5rem;
        background: var(--color-bg-page); border: 1px dashed var(--color-border); border-radius: 4px;
    }
    
    .points-display.error { color: #e74c3c; border-color: #e74c3c; background: #fadbd8; }

    .block-warning { font-size: 0.8em; color: #e74c3c; font-style: italic; display: none; }
    .block-warning.active { display: inline; }

    /* Class Section */
    .class-row {
        display: grid;
        grid-template-columns: 80px 1fr 1fr; /* Version | Class | Subclass */
        gap: 0.5rem;
        margin-bottom: 0.5rem;
        align-items: center;
        padding: 10px;
        background: var(--color-bg-medium);
        border: 1px solid var(--color-border);
        border-radius: 4px;
    }
    
    /* Second row of the Class Block grid for Level and Remove button */
    .class-row-bottom {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: 0.5rem;
        margin-top: 0.5rem;
    }

    /* Container for the whole class block */
    .class-block {
        display: flex;
        flex-direction: column;
        padding: 10px;
        background: var(--color-bg-medium);
        border: 1px solid var(--color-border);
        border-radius: 4px;
        margin-bottom: 0.75rem;
    }

    .class-select, .version-select, .subclass-select {
        padding: 8px;
        border: 1px solid var(--color-border);
        background: var(--color-bg-page);
        color: var(--color-text);
        border-radius: 4px;
        width: 100%;
    }

    .level-wrapper {
        display: flex;
        align-items: center;
        gap: 5px;
        width: 100px;
    }

    .level-label {
        font-weight: bold;
        font-size: 0.9em;
        color: var(--color-primary);
    }

    .level-input {
        width: 100%;
        padding: 8px;
        border: 1px solid var(--color-border);
        background: var(--color-bg-page);
        color: var(--color-text);
        border-radius: 4px;
        text-align: center;
    }

    .remove-class-btn {
        background: #e74c3c; color: white; border: none; width: 32px; height: 32px;
        border-radius: 4px; cursor: pointer; display: flex; align-items: center; justify-content: center;
        align-self: flex-end;
    }
    
    .remove-wrapper {
        display: flex;
        justify-content: flex-end;
        align-items: center;
    }

    /* Feat Cards */
    .feat-card {
        background: var(--color-bg-medium); border: 2px solid var(--color-border);
        padding: 1rem; margin-bottom: 1rem; border-radius: 4px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .feat-header {
        font-weight: bold; color: var(--color-primary); border-bottom: 2px solid var(--color-border);
        padding-bottom: 0.25rem; margin-bottom: 0.5rem;
    }
</style>

<div class="page">

    <h1>Character Rework Tool</h1>
    <p>Use this tool to compare your original character build against a new specialization.</p>

    <div id="auth-component" class="auth-wrapper">
        <span id="auth-loading" class="auth-loading-text">Loading...</span>

        <button id="login-btn" class="auth-btn auth-btn-discord" style="display:none;">
            <svg class="discord-logo" width="20" height="20" viewBox="0 0 127.14 96.36">
                <path fill="currentColor" d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.11,77.11,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.89,105.89,0,0,0,126.6,80.22c2.36-24.44-2.54-47.89-18.9-72.15ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5.18-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/>
            </svg>
            Login with Discord
        </button>

        <div id="user-profile" class="auth-profile" style="display:none;">
            <img id="user-avatar" src="" alt="User" class="auth-avatar" onerror="this.style.display='none'">
            <div class="auth-user-info">
                <span id="user-name" class="auth-name">Adventurer</span>
                <span id="user-role-badge" class="auth-role-badge">Member</span>
            </div>
            <button id="logout-btn" class="auth-btn auth-btn-logout" title="Sign Out">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                    <polyline points="16 17 21 12 16 7"></polyline>
                    <line x1="21" y1="12" x2="9" y2="12"></line>
                </svg>
            </button>
        </div>
    </div>


    <div class="respec-container">
        
        <div class="char-column" id="col-original">
            <h2 class="column-header">Original Character</h2>

            <div class="card">
                <h3 class="card-title">Character Origin</h3>
                <div class="origin-grid">
                    
                    <div class="input-group">
                        <label class="input-label">Character Name</label>
                        <input type="text" class="text-input" placeholder="Name">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Base Attributes (27 Point Buy)</label>
                        <div id="attrs-container-original">
                            </div>
                        <div class="points-display" id="points-original">Points Remaining: 27</div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">(Race: Version, Race, and subrace (if applicable) )</label>
                        <input type="text" class="text-input" placeholder="e.g. Human, Elf...">
                    </div>

                    <div class="input-group" id="block-race-original">
                        <label class="input-label">
                            Racial Bonuses 
                            <span class="block-warning">Max 3 total!</span>
                        </label>
                        <div id="race-mod-container-original"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Origin (Background)</label>
                        <input type="text" class="text-input" placeholder="e.g. Acolyte">
                    </div>

                    <div class="input-group" id="block-origin-original">
                        <label class="input-label">
                            Origin Feat
                            <span class="block-warning">Max 3 total!</span>
                        </label>
                        <input type="text" class="text-input" placeholder="e.g. Magic Initiate">
                        
                        <div id="origin-mod-container-original"></div>
                    </div>

                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Classes</h3>
                <div id="classes-container-original"></div>
                <button type="button" class="button button-secondary" style="margin-top: 10px;" onclick="window.addClassRow('original')">+ Add Class</button>
            </div>

            <div id="feats-container-original"></div>
        </div>


        <div class="char-column" id="col-new">
            <h2 class="column-header">New Character</h2>

            <div class="card">
                <h3 class="card-title">Character Origin</h3>
                <div class="origin-grid">
                    
                    <div class="input-group">
                        <label class="input-label">Character Name</label>
                        <input type="text" class="text-input" placeholder="Name">
                    </div>

                    <div class="input-group">
                        <label class="input-label">Base Attributes (27 Point Buy)</label>
                        <div id="attrs-container-new">
                            </div>
                        <div class="points-display" id="points-new">Points Remaining: 27</div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">(Race: Version, Race, and subrace (if applicable) )</label>
                        <input type="text" class="text-input" placeholder="e.g. Human, Elf...">
                    </div>

                    <div class="input-group" id="block-race-new">
                        <label class="input-label">
                            Racial Bonuses
                            <span class="block-warning">Max 3 total!</span>
                        </label>
                        <div id="race-mod-container-new"></div>
                    </div>

                    <div class="input-group">
                        <label class="input-label">Origin (Background)</label>
                        <input type="text" class="text-input" placeholder="e.g. Acolyte">
                    </div>

                    <div class="input-group" id="block-origin-new">
                        <label class="input-label">
                            Origin Feat
                            <span class="block-warning">Max 3 total!</span>
                        </label>
                        <input type="text" class="text-input" placeholder="e.g. Magic Initiate">
                        
                        <div id="origin-mod-container-new"></div>
                    </div>

                </div>
            </div>

            <div class="card">
                <h3 class="card-title">Classes</h3>
                <div id="classes-container-new"></div>
                <button type="button" class="button button-secondary" style="margin-top: 10px;" onclick="window.addClassRow('new')">+ Add Class</button>
            </div>

            <div id="feats-container-new"></div>
        </div>

    </div>

    <div class="card" style="margin-top: 2rem;">
        <h3 class="card-title">Rework Details</h3>
        
        <div class="input-group" style="margin-bottom: 1rem;">
            <label class="input-label">Rework Costs</label>
            <input type="text" class="text-input" placeholder="Rework Type, DTP and Cost">
        </div>

        <div class="input-group">
            <label class="input-label">Notes</label>
            <textarea class="notes-area" style="min-height: 150px;" placeholder="Summary of character changes"></textarea>
        </div>
    </div>
</div>

<script type="module" src="{{ '/assets/js/auth-manager.js' | relative_url }}"></script>

<script>
    (function() {
        const getEl = (id) => document.getElementById(id);
        const ui = {
            loading: getEl('auth-loading'),
            loginBtn: getEl('login-btn'),
            profile: getEl('user-profile'),
            avatar: getEl('user-avatar'),
            name: getEl('user-name'),
            roleBadge: getEl('user-role-badge'),
            logoutBtn: getEl('logout-btn')
        };
    
        const updateAuthUI = (user, profile) => {
            ui.loading.style.display = 'none';
            if (user) {
                ui.loginBtn.style.display = 'none';
                ui.profile.style.display = 'flex';
                ui.name.textContent = (profile && profile.username) ? profile.username : (user.user_metadata.full_name || 'User');
                if (user.user_metadata.avatar_url) {
                    ui.avatar.src = user.user_metadata.avatar_url;
                    ui.avatar.style.display = 'block';
                }
                ui.roleBadge.textContent = (profile && profile.role) ? profile.role : "Member";
                ui.roleBadge.style.display = 'inline-block';
            } else {
                ui.loginBtn.style.display = 'inline-flex';
                ui.profile.style.display = 'none';
            }
        };
    
        const initAuth = () => {
            if (window.authManager) {
                ui.loginBtn.onclick = () => window.authManager.login();
                ui.logoutBtn.onclick = () => window.authManager.logout();
                window.authManager.init(updateAuthUI);
            } else {
                setTimeout(initAuth, 100);
            }
        };
    
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initAuth);
        } else {
            initAuth();
        }
    })();
</script>

<script type="module">
    import { supabase } from "{{ '/assets/js/supabaseClient.js' | relative_url }}";

    // --- 1. DATA CONSTANTS ---
    const ATTRIBUTES = ['STR', 'DEX', 'CON', 'INT', 'WIS', 'CHA'];
    const POINT_BUY_TOTAL = 27;
    const POINT_COSTS = {
        8: 0, 9: 1, 10: 2, 11: 3, 12: 4, 13: 5, 14: 7, 15: 9
    };
    
    // EMBEDDED DATA FROM CSV (Fallback)
    // Structure: {version, class, subclass, ASI[]}
    const FULL_CHARACTER_DATA = [{"version": 2014, "class": "Artificer (ERLW/TCE)", "subclass": "Alchemist (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Artificer (ERLW/TCE)", "subclass": "Armorer (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Artificer (ERLW/TCE)", "subclass": "Artillerist (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Artificer (ERLW/TCE)", "subclass": "Battlesmith (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Ancestral Guardian (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Battlerager (SCAG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Battlerager (HTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Beast (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Berserker (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Storm Herald XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Giant (BGG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Totem Warrior (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Wild Magic (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Barbarian (PHB 2014)", "subclass": "Zealot (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Creation (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Eloquence (MOT)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Glamour (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Lore (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Road (HWCS)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Satire (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Spirits (VRGR)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Swords (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Valor (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Bard (PHB 2014)", "subclass": "Whispers (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Blood Hunter (DDB)", "subclass": "Ghostslayer", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Blood Hunter (DDB)", "subclass": "Lycan", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Blood Hunter (DDB)", "subclass": "Mutant", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Blood Hunter (DDB)", "subclass": "Profane Soul", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Arcana (SCAG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Community (HWCS)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Death (DMG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Forge (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Grave (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Knowledge (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Life (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Light (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Nature (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Night (HWCS)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Order (GGR)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Peace (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Protection (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Tempest (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Twilight (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "Trickery (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Cleric (PHB 2014)", "subclass": "War (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Dragons (GSB2)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Dreams (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Land (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Moon (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Shepherd (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Stars (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Spores (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Twilight (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Warden (HWT)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Druid (PHB 2014)", "subclass": "Wildfire (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Arcane Archer (XGTE)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Battle Master (PHB 2014)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Cavalier (XGTE)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Champion (PHB 2014)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Echo Knight (EGW)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Eldritch Knight (PHB 2014)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Psi Warrior (TCE)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Purple Dragon Knight (SCAG)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Purple Dragon Knight (HTA)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Rune Knight (TCE)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Samurai (XGTE)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Scofflaw (HWCS)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Fighter (PHB 2014)", "subclass": "Sharpshooter (UA) ", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Ascendant Dragon (FTD)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Astral Self (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Drunken Master (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Four Elements (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Four Elements (Spiketail.Drake)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Kensei (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Long Death (SCAG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Mercy (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Open Hand (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Serenity (HTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Shadow (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Monk (PHB 2014)", "subclass": "Sun Soul (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Avatar", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Awakened", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Immortal", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Nomad", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Soul Knife", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Mystic (UA)", "subclass": "Wu Jen", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Ancients (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Conquest (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Crown (SCAG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Devotion (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Glory (MOT, TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Oathbreaker (DMG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Redemption (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Treachery (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Vengeance (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Paladin (PHB 2014)", "subclass": "Watchers (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Ranger (PHB 2014)", "subclass": null, "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Beast Master / Beast Conclave (PHB 2014 or UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Drakewarden (FTD)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Fey Wanderer (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Gloom Stalker (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Horizon Walker (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Hunter / Hunter Conclave (PHB 2014 or UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Monster Slayer (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Primeval Guardian (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Revised Ranger (UA)", "subclass": "Swarmkeeper (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Arcane Trickster (PHB 2014)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Assassin (PHB 2014)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Inquisitive (XGTE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Mastermind (XGTE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Phantom (TCE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Scout (XGTE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Soulknife (TCE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Swashbuckler (XGTE)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Rogue (PHB 2014)", "subclass": "Thief (PHB 2014)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Aberrant Mind (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Clockwork Soul (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Divine Soul (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Draconic (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Lunar (DSotDQ)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Phoenix (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Sea (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Shadow (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Stone (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Storm (SCAG & XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Sorcerer (PHB 2014)", "subclass": "Wild Magic (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Archfey (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Celestial (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Fathomless (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Fiend (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Genie (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Great Old One (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Hexblade (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Predator (HWT)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Raven Queen (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Seeker (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Undead (VRGR)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Warlock (PHB 2014)", "subclass": "Undying (SCAG)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Abjuration (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Artificer (HTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Bladesinging (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Chronurgy (EGW)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Conjuration (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Divination (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Enchantment (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Evocation (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Graviturgy (EGW)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Illusion (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Invention (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Leyline (HWT)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Necromancy (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Scribes (TCE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Theurgy (UA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "Transmutation (PHB 2014)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2014, "class": "Wizard (PHB 2014)", "subclass": "War Magic (XGTE)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Artificer (EFOTA)", "subclass": "Alchemist (EFOTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Artificer (EFOTA)", "subclass": "Armorer (EFOTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Artificer (EFOTA)", "subclass": "Artillerist (EFOTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Artificer (EFOTA)", "subclass": "Battlesmith (EFOTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Artificer (EFOTA)", "subclass": "Cartographer (EFOTA)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Barbarian (PHB 2024)", "subclass": "Berserker (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Barbarian (PHB 2024)", "subclass": "Wild Heart (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Barbarian (PHB 2024)", "subclass": "World Tree (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Barbarian (PHB 2024)", "subclass": "Zealot (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Dance (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Glamour (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Lore (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Moon (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Road (HWCS 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Bard (PHB 2024)", "subclass": "Valor (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Community (HWCS 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Life (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Light (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Knowledge (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Night (HWCS 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "Trickery (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Cleric (PHB 2024)", "subclass": "War (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Druid (PHB 2024)", "subclass": "Land (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Druid (PHB 2024)", "subclass": "Moon (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Druid (PHB 2024)", "subclass": "Sea (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Druid (PHB 2024)", "subclass": "Stars (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Banneret (FRHOF)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Battle Master (PHB 2024)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Champion (PHB 2024)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Eldritch Knight (PHB 2024)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Psi Warrior (PHB 2024)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Fighter (PHB 2024)", "subclass": "Scofflaw (HWCS 2024)", "ASI": [4, 6, 8, 12, 14, 16, 19]}, {"version": 2024, "class": "Monk (PHB 2024)", "subclass": "Mercy (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Monk (PHB 2024)", "subclass": "Shadow (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Monk (PHB 2024)", "subclass": "Elements (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Monk (PHB 2024)", "subclass": "Open Hand (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Paladin (PHB 2024)", "subclass": "Ancients (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Paladin (PHB 2024)", "subclass": "Devotion (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Paladin (PHB 2024)", "subclass": "Glory (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Paladin (PHB 2024)", "subclass": "Noble Genies (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Paladin (PHB 2024)", "subclass": "Vengeance (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Ranger (PHB 2024)", "subclass": "Beast Master (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Ranger (PHB 2024)", "subclass": "Fey Wanderer (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Ranger (PHB 2024)", "subclass": "Gloom Stalker (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Ranger (PHB 2024)", "subclass": "Hunter (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Ranger (PHB 2024)", "subclass": "Winter Walker (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Arachnoid Stalker (VSS:PP)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Arcane Trickster (PHB 2024)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Assassin (PHB 2024)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Scion of the Three (FRHOF)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Soulknife (PHB 2024)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Rogue (PHB 2024)", "subclass": "Thief (PHB 2024)", "ASI": [4, 6, 8, 10, 12, 16, 19]}, {"version": 2024, "class": "Sorcerer (PHB 2024)", "subclass": "Aberrant (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Sorcerer (PHB 2024)", "subclass": "Clockwork (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Sorcerer (PHB 2024)", "subclass": "Draconic (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Sorcerer (PHB 2024)", "subclass": "Spellfire (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Sorcerer (PHB 2024)", "subclass": "Wild Magic (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Warlock (PHB 2024)", "subclass": "Archfey (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Warlock (PHB 2024)", "subclass": "Celestial (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Warlock (PHB 2024)", "subclass": "Fiend (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Warlock (PHB 2024)", "subclass": "Great Old One (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Wizard (PHB 2024)", "subclass": "Abjurer (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Wizard (PHB 2024)", "subclass": "Bladesinger (FRHOF)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Wizard (PHB 2024)", "subclass": "Diviner (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Wizard (PHB 2024)", "subclass": "Evoker (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}, {"version": 2024, "class": "Wizard (PHB 2024)", "subclass": "Illusionist (PHB 2024)", "ASI": [4, 8, 12, 16, 19]}];


    // --- 2. GLOBAL FUNCTIONS ---
    
    window.addClassRow = function(colId) {
        const container = document.getElementById(`classes-container-${colId}`);
        if(!container) return;

        const block = document.createElement('div');
        block.className = 'class-block';

        // --- ROW 1: SELECTS ---
        const rowTop = document.createElement('div');
        rowTop.className = 'class-row';

        // 1. Version Select
        const verSelect = document.createElement('select');
        verSelect.className = 'version-select';
        verSelect.innerHTML = `<option value="">Ver</option>
                               <option value="2014">2014</option>
                               <option value="2024">2024</option>`;
        
        // 2. Class Select (initially disabled)
        const classSelect = document.createElement('select');
        classSelect.className = 'class-select';
        classSelect.innerHTML = `<option value="">- Class -</option>`;
        classSelect.disabled = true;

        // 3. Subclass Select (initially disabled)
        const subSelect = document.createElement('select');
        subSelect.className = 'subclass-select';
        subSelect.innerHTML = `<option value="">- Subclass -</option>`;
        subSelect.disabled = true;

        rowTop.appendChild(verSelect);
        rowTop.appendChild(classSelect);
        rowTop.appendChild(subSelect);

        // --- ROW 2: LEVEL & REMOVE ---
        const rowBottom = document.createElement('div');
        rowBottom.className = 'class-row-bottom';

        // Level Input
        const lvlWrapper = document.createElement('div');
        lvlWrapper.className = 'level-wrapper';
        const lvlLabel = document.createElement('span');
        lvlLabel.className = 'level-label';
        lvlLabel.innerText = "Lvl:";
        const lvlInput = document.createElement('input');
        lvlInput.type = 'number';
        lvlInput.className = 'level-input';
        lvlInput.min = 1;
        lvlInput.max = 20;
        lvlInput.value = 1;
        lvlWrapper.appendChild(lvlLabel);
        lvlWrapper.appendChild(lvlInput);

        // Remove Button
        const removeWrapper = document.createElement('div');
        removeWrapper.className = 'remove-wrapper';
        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'remove-class-btn';
        removeBtn.innerHTML = "&times;";
        removeBtn.onclick = function() {
            container.removeChild(block);
            generateFeatCards(colId);
        };
        removeWrapper.appendChild(removeBtn);

        rowBottom.appendChild(lvlWrapper);
        rowBottom.appendChild(removeWrapper);

        block.appendChild(rowTop);
        block.appendChild(rowBottom);
        container.appendChild(block);

        // --- EVENTS ---
        
        // Version Change: Populate Classes
        verSelect.addEventListener('change', () => {
            const ver = parseInt(verSelect.value);
            
            // Reset Class & Subclass
            classSelect.innerHTML = `<option value="">- Class -</option>`;
            subSelect.innerHTML = `<option value="">- Subclass -</option>`;
            subSelect.disabled = true;
            
            if (!ver) {
                classSelect.disabled = true;
                return;
            }

            classSelect.disabled = false;

            // Filter classes by version
            const classes = [...new Set(
                FULL_CHARACTER_DATA
                    .filter(item => item.version === ver)
                    .map(item => item.class)
            )].sort();

            classes.forEach(cls => {
                const opt = document.createElement('option');
                opt.value = cls;
                opt.text = cls;
                classSelect.appendChild(opt);
            });
            
            generateFeatCards(colId);
        });

        // Class Change: Populate Subclasses
        classSelect.addEventListener('change', () => {
            const ver = parseInt(verSelect.value);
            const cls = classSelect.value;
            
            // Reset Subclass
            subSelect.innerHTML = `<option value="">- Subclass -</option>`;
            
            if (!cls) {
                subSelect.disabled = true;
                generateFeatCards(colId);
                return;
            }

            subSelect.disabled = false;

            // Filter subclasses by version + class
            const subclasses = [...new Set(
                FULL_CHARACTER_DATA
                    .filter(item => item.version === ver && item.class === cls && item.subclass)
                    .map(item => item.subclass)
            )].sort();

            if (subclasses.length > 0) {
                 subclasses.forEach(sub => {
                    const opt = document.createElement('option');
                    opt.value = sub;
                    opt.text = sub;
                    subSelect.appendChild(opt);
                });
            } else {
                 // Handle classes with no subclass in data (if any)
                 const opt = document.createElement('option');
                 opt.value = "None";
                 opt.text = "None";
                 subSelect.appendChild(opt);
                 subSelect.value = "None"; // Auto-select
            }
           
            generateFeatCards(colId);
        });

        subSelect.addEventListener('change', () => generateFeatCards(colId));
        lvlInput.addEventListener('change', () => generateFeatCards(colId));
        lvlInput.addEventListener('input', () => generateFeatCards(colId));
        
        // Initial Trigger (empty)
        generateFeatCards(colId);
    }

    // --- 3. RENDERING & CALCULATIONS ---

    function createStatTableHTML(type, colId, contextId) {
        let html = `<table class="stat-table" data-block-id="${contextId}"><thead><tr>`;
        ATTRIBUTES.forEach(attr => html += `<th>${attr}</th>`);
        html += `</tr></thead><tbody><tr>`;
        
        ATTRIBUTES.forEach(attr => {
            html += `<td>
                <select class="mod-select-cell mod-select-${type}" data-col="${colId}" data-attr="${attr}" data-context="${contextId}">
                    <option value="0">0</option>
                    <option value="1">+1</option>
                    <option value="2">+2</option>
                </select>
            </td>`;
        });
        
        html += `</tr></tbody></table>`;
        return html;
    }

    function renderStaticTables(colId) {
        const raceContainer = document.getElementById(`race-mod-container-${colId}`);
        if(raceContainer) raceContainer.innerHTML = createStatTableHTML('race', colId, `race-${colId}`);

        const originContainer = document.getElementById(`origin-mod-container-${colId}`);
        if(originContainer) originContainer.innerHTML = createStatTableHTML('origin', colId, `origin-${colId}`);
        
        const finalContainer = document.getElementById(`final-stats-container-${colId}`);
        if(finalContainer) {
            let html = `<table class="stat-table final-stats-table"><thead><tr>`;
            ATTRIBUTES.forEach(attr => html += `<th>${attr}</th>`);
            html += `</tr></thead><tbody><tr>`;
            ATTRIBUTES.forEach(attr => {
                html += `<td id="final-${colId}-${attr}">10</td>`;
            });
            html += `</tr></tbody></table>`;
            finalContainer.innerHTML = html;
        }
        
        attachModListeners(colId);
    }

    function renderBaseAttributes(colId) {
        const container = document.getElementById(`attrs-container-${colId}`);
        if (!container) return;
        
        const table = document.createElement('table');
        table.className = 'stat-table';

        let thead = "<thead><tr>";
        ATTRIBUTES.forEach(attr => thead += `<th>${attr}</th>`);
        thead += "</tr></thead>";

        let tbody = "<tbody><tr>";
        ATTRIBUTES.forEach(attr => {
            tbody += `<td><input type="number" class="attr-input-cell" id="attr-${colId}-${attr}" value="10" min="8" max="15"></td>`;
        });
        tbody += "</tr></tbody>";

        table.innerHTML = thead + tbody;
        container.innerHTML = '';
        container.appendChild(table);

        ATTRIBUTES.forEach(attr => {
            const input = document.getElementById(`attr-${colId}-${attr}`);
            input.addEventListener('input', () => {
                calculatePointBuy(colId);
                calculateFinalStats(colId);
            });
        });

        calculatePointBuy(colId);
    }

    function generateFeatCards(colId) {
        const classContainer = document.getElementById(`classes-container-${colId}`);
        const featContainer = document.getElementById(`feats-container-${colId}`);
        if(!featContainer || !classContainer) return;
        
        featContainer.innerHTML = '';

        const blocks = classContainer.getElementsByClassName('class-block');
        
        Array.from(blocks).forEach((block, index) => {
            const verSelect = block.querySelector('.version-select');
            const classSelect = block.querySelector('.class-select');
            const subSelect = block.querySelector('.subclass-select');
            const levelInput = block.querySelector('.level-input');
            
            const ver = parseInt(verSelect.value);
            const cls = classSelect.value;
            const sub = subSelect.value;
            const level = parseInt(levelInput.value) || 0;

            if (!ver || !cls || level < 1) return;

            // Find matching data entry
            // 1. Try specific subclass match
            let dataEntry = FULL_CHARACTER_DATA.find(item => 
                item.version === ver && item.class === cls && item.subclass === sub
            );

            // 2. Fallback: Try class match where subclass is null/undefined in data (e.g. Ranger base)
            if (!dataEntry) {
                 dataEntry = FULL_CHARACTER_DATA.find(item => 
                    item.version === ver && item.class === cls && !item.subclass
                );
            }

            if (dataEntry && dataEntry.ASI) {
                const achievedASIs = dataEntry.ASI.filter(asiLevel => asiLevel <= level);

                achievedASIs.forEach((asiLevel) => {
                    const uniqueId = `feat-${colId}-${cls}-${index}-${asiLevel}`;
                    const card = createFeatCard(cls, asiLevel, colId, uniqueId);
                    featContainer.appendChild(card);
                });
            }
        });

        attachModListeners(colId);
        calculateFinalStats(colId); 
    }

    function createFeatCard(className, level, colId, contextId) {
        const card = document.createElement('div');
        card.className = 'feat-card';
        card.id = `card-${contextId}`;

        const header = document.createElement('div');
        header.className = 'feat-header';
        
        header.innerHTML = `${className} - Level ${level} ASI/Feat <span class="block-warning" id="warn-${contextId}">Max 3 total!</span>`;

        const inputsDiv = document.createElement('div');
        inputsDiv.className = 'input-group';

        const nameInput = document.createElement('input');
        nameInput.type = 'text';
        nameInput.className = 'text-input';
        nameInput.placeholder = "Feat Name (or +2 ASI)";

        inputsDiv.appendChild(nameInput);
        card.appendChild(header);
        card.appendChild(inputsDiv);
        
        const tableContainer = document.createElement('div');
        tableContainer.innerHTML = createStatTableHTML('feat', colId, contextId);
        card.appendChild(tableContainer);

        return card;
    }

    // --- 4. LOGIC: POINTS, VALIDATION, TOTALS ---

    function attachModListeners(colId) {
        const selects = document.querySelectorAll(`select[data-col="${colId}"]`);
        selects.forEach(sel => {
            sel.onchange = () => {
                validateBlock(sel.dataset.context);
                calculateFinalStats(colId);
            };
        });
    }

    function validateBlock(contextId) {
        if(!contextId) return;

        const inputs = document.querySelectorAll(`select[data-context="${contextId}"]`);
        let sum = 0;
        inputs.forEach(input => sum += parseInt(input.value) || 0);

        let warningEl;
        
        if(contextId.startsWith('race')) {
            warningEl = document.querySelector(`#block-race-${contextId.split('-')[1]} .block-warning`);
        } else if(contextId.startsWith('origin')) {
            warningEl = document.querySelector(`#block-origin-${contextId.split('-')[1]} .block-warning`);
        } else {
            // Feat
            warningEl = document.getElementById(`warn-${contextId}`);
        }

        if(warningEl) {
            if(sum > 3) warningEl.classList.add('active');
            else warningEl.classList.remove('active');
        }
    }

    function calculatePointBuy(colId) {
        let spent = 0;
        let valid = true;

        ATTRIBUTES.forEach(attr => {
            const input = document.getElementById(`attr-${colId}-${attr}`);
            if(!input) return;
            const val = parseInt(input.value);
            if (val < 8 || val > 15) valid = false;
            if (POINT_COSTS[val] !== undefined) spent += POINT_COSTS[val];
        });

        const remaining = POINT_BUY_TOTAL - spent;
        const display = document.getElementById(`points-${colId}`);
        
        display.innerText = `Points Remaining: ${remaining}`;
        
        if (remaining < 0 || !valid) {
            display.classList.add('error');
            if (!valid) display.innerText += " (Attributes must be 8-15)";
        } else {
            display.classList.remove('error');
        }
    }

    function calculateFinalStats(colId) {
        ATTRIBUTES.forEach(attr => {
            let total = 0;

            // 1. Base
            const baseInput = document.getElementById(`attr-${colId}-${attr}`);
            if(baseInput) total += parseInt(baseInput.value) || 0;

            // 2. All Dropdowns for this attribute in this column
            const mods = document.querySelectorAll(`select[data-col="${colId}"][data-attr="${attr}"]`);
            mods.forEach(mod => total += parseInt(mod.value) || 0);

            // 3. Update Display
            const finalCell = document.getElementById(`final-${colId}-${attr}`);
            if(finalCell) finalCell.innerText = total;
        });
    }


    // --- 5. INIT ---

    async function initSupabase() {
        try {
            // If you want to use Supabase, un-comment the fetching logic. 
            // For now, we use FULL_CHARACTER_DATA as the primary source 
            // since it contains all the needed fields (version, subclass, etc.)
            
            // const { data, error } = await supabase...
            // If using DB, you'd need to parse the JSONB column similarly.
            
            console.log("Using embedded character data.");
        } catch (err) {
            console.warn("Supabase init error:", err);
        }
    }

    function startApp() {
        ['original', 'new'].forEach(col => {
            renderStaticTables(col);
            renderBaseAttributes(col);
            window.addClassRow(col); 
            calculateFinalStats(col);
        });
        initSupabase();
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', startApp);
    } else {
        startApp();
    }

</script>